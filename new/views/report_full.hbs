<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/style2.css">
        <link rel="stylesheet" href="/style_report.css">


    {{!-- generate pdf requirement --}}
    <link href="https://fonts.googleapis.com/css?family=Raleway:400,300,600,800,900" rel="stylesheet" type="text/css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script> 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
    {{!-- chart js requirement --}}
 <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"> </script>
 
<script src="/assets/plugins/apexcharts/apexcharts.min.js"></script>
    <script src="/assets/plugins/apexcharts/irregular-data-series.js"></script>
    <script src="/assets/plugins/apexcharts/ohlc.js"></script>
    {{!-- <script src="/assets/pages/apexcharts.init.js"></script> --}}
    <!-- App js -->
    <script src="/assets/js/app.js"></script>
    <title>Analysis Dashboard</title>
</head>


<body>

    <div class="invoice-box" id="divToExport">
        <table cellpadding="0" cellspacing="0">
            <tr class="top">
                <td colspan="2">
                    <table>
                        <tr>
                            <td class="title">
                                <img src="/img/intel.png" style="width:100%; max-width:300px;">
                            </td>
                            
                            <td>
                                assessment #: {{this.id}}<br>
                                Created : {{this.date}}<br>
                               
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            
            <tr class="information">
                <td colspan="2">
                    <table>
                        <tr>
                            <td>
                                {{#each company}}
       
          
                               <b>{{this.company}}</b> <br>
                                {{this.state}}<br>
                               {{this.city}}
                            </td>
            
            {{/each}}
                          
                            <td>
                                   {{#each creator}}
       
          
                              
                                {{this.username}}<br>
                                {{this.mail}} <br>
                                {{this.adress}}
            {{/each}}
                                
                              
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            
            <tr class="heading">
                <td>
                   assessment details :  
                </td>
                
                <td>
                
                </td>
            </tr>
            <tr class="item">
                <td>
                    name :              <br>

                </td>
                            <br>

                 <td>
                {{this.ass_name.title}}
                </td>
              {{#each industry }}
                     <tr class="item">
                  <td>  company industry  :  </td>        
                <td>  {{this.industry}}</td>
                     </tr>

                      <tr class="item">
                  <td>  company sector  :  </td>        
                <td>  {{this.sector}}</td>
                     </tr>

                      <tr class="item">
                  <td>  company effort  :  </td>        
                <td>  {{this.effort}}</td>
                     </tr>

                      <tr class="item">
                  <td>  organisation type  :  </td>        
                <td>  {{this.type}}</td>
                     </tr>
            
            {{/each}}


            </tr>
            
            <tr class="heading">
                <td>
                    assessment summary 
                </td>
                
                <td>
                    
                </td>
            </tr>
            
            <tr class="details">
                <td>
                    


<div class="row" >
                    <div class="col-lg-12" >
                        <div class="card" >
                            <div class="card-header">
                                <h4 class="card-title">summary </h4>
                            </div><!--end card-header-->
                            <div class="card-body">
                                <div class="chart-demo">
                                    <div id="apex_bar2" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->
                     <!-- Javascript  -->
    


                </td>
                
                {{!-- <td>
                    $300.00
                </td> --}}
            </tr>
             <tr>  <td hidden> ...</td></tr>
                          <tr></tr>

  <tr class="heading">
                <td>
                  compliance per category 
                </td>
                
                <td>
                    
                </td>
            </tr>
            
  <tr class="details">

    <td>

        <div class="col-lg-12">
                        <div class="card">
                            <div class="card-header">
                                <h4 class="card-title">categories</h4>
                            </div><!--end card-header-->
                            <div class="card-body">
                                <div class="chart-demo">
                                    <div id="apex_column1" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->
    </td>
  </tr>


            <tr class="item">
                <td>
                  vulnerable by
                </td>
                
                <td>
  
  
<p id="demo1" style="color: red; font-size:35px " >%</p>
  
                </td>
            </tr>
            
            <tr class="item last">
                <td>
                   secured by
                </td>
                
                <td>
                                     <p id="demo" style="color: red; font-size:35px " >%</p>

                </td>
            </tr>
{{!--             
            <tr class="total">
                <td></td>
                    
                <td>
                   Total: $385.00
                </td>
            </tr> --}}
        </table>
    </div>

        <button type="button" onclick="generatePDF()" class="btn-sm btn-alert " style="margin-left: 350px; margin-top: 50px;">Export to PDF</button>

    {{!-- ----------------------------------------------------------- --}}
{{!-- <div id="container"></div> --}}
{{!-- 
<h1>Analysis Dashboard</h1> <br>
  <div class="col-lg-4">
                        <div class="card">
                            <div class="card-header">
                                <h4 class="card-title">complience rate :</h4>
                            </div><!--end card-header-->
                            <div class="card-body">
                                <div class="chart-demo m-0">
                                    <div id="apex_radialbar3" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->       --}}

{{!-- 
<script>
 var comp = parseInt(({{data.yess}}*100)/({{data.noo}}+{{data.yess}}));
  //Apex-radialbar3
  var options = {
    chart: {
        height: 380,
        type: 'radialBar',
    },
    plotOptions: {
        radialBar: {
            startAngle: -135,
            endAngle: 135,
            track: {
              background: '#b9c1d4',
              opacity: 0.3,            
            },
            dataLabels: {
                name: {
                    fontSize: '16px',
                    color: '#8997bd',
                    offsetY: 120
                },
                value: {
                    offsetY: 76,
                    fontSize: '22px',
                    color: '#8997bd',
                    formatter: function (val) {
                        return val + "%";
                    }
                }
            }
        }
    },
    fill: {
        gradient: {
            enabled: true,
            shade: 'dark',
            shadeIntensity: 0.15,
            inverseColors: false,
            opacityFrom: 1,
            opacityTo: 1,
            stops: [0, 50, 65, 91]
        },
    },
    stroke: {
        dashArray: 4
    },
    colors: ["#28ed39"],
    series: [comp],
    labels: ['Compliance Ratio'],
    responsive: [{
        breakpoint: 380,
        options: {
          chart: {
            height: 280
          }
        }
    }]
  }
  
  var chart = new ApexCharts(
    document.querySelector("#apex_radialbar3"),
    options
  );
  
  chart.render();


</script> --}}
{{!-- <script>

var total_goals = 10;
var goals_completed = 5;

var bar = new ProgressBar.Circle(container, {
  color: '#aaa',
  // This has to be the same size as the maximum width to
  // prevent clipping
  strokeWidth: 4,
  trailWidth: 1,
  easing: 'easeInOut',
  duration: 1400,
  text: {
    autoStyleContainer: false
  },
  from: { color: '#2a76f4', width: 1 },
  to: { color: '#fa0505', width: 4 },
  // Set default step function for all animate calls
  step: function(state, circle) {
    circle.path.setAttribute('stroke', state.color);
    circle.path.setAttribute('stroke-width', state.width);

    var value = Math.round(circle.value() * 100);
    if (value === 0) {
      circle.setText('');
    } else {
      circle.setText(value);
    }

  }
});
bar.text.style.fontFamily = '"Raleway", Helvetica, sans-serif';
bar.text.style.fontSize = '2rem';

bar.animate(goals_completed/total_goals);  // Number from 0.0 to 1.0



</script> --}}

 {{!-- <div class="col-sm-6" id="divToExports"> --}}


{{!-- THese Are your DAta --}}
  {{!-- {{#each data}} --}}
       
         {{!-- <br>
             
            
          

<canvas id="myChart" style="width:100%;max-width:700px"></canvas> --}}
{{!-- charjs script --}}

<script>


var xValues = ["secured", "Not secured", "no answer"];
var yValues = [{{data.yess}} ,{{data.noo}} ,{{data.idk}} ];
var barColors = [
  "#2a76f4",
  "#fa0505",
  "#5D5B58",

];
var col = [
 'blue  ',
 'blue',
 'blue'
];



new Chart("myChart", {
  type: "pie",
  
  data: {
    labels: xValues,
    datasets: [{
      backgroundColor: barColors,
      borderColor: col,
      
      data: yValues
    }]
  },
  options: {
    title: {
      display: true,
      text: "results "
    }
  }
});
</script>

  {{!-- {{/each}} --}}
  {{!-- <br>
  <h1>your company is secured by : </h1>
<p id="demo" style="color: red; font-size:35px " >%</p>
  
   <br>
  <h1>your company is vulnerable by : </h1>
<p id="demo1" style="color: red; font-size:35px " >%</p>
   --}}

{{!-- <p id="demo1">%</p>
<p id="demo2">%</p> --}}


  {{!-- </div> --}}
                {{!-- <a href="/question/full_report/{{this.id}}" class="btn btn-sm btn-warning"> full report </a> --}}
{{!-- pdf generate script --}}
  <script type="text/javascript">
  function generatePDF() {
        
        // Choose the element id which you want to export.
        var element = document.getElementById('divToExport');
        element.style.width = '100%';
        element.style.height = '100%';
        var opt = {
            margin:       0.5,
            filename:     'report.pdf',
            image:        { type: 'jpeg', quality: 1 },
            html2canvas:  { scale: 1 },
            jsPDF:        { unit: 'mm', format: 'a4', orientation: 'portrait',precision: '12' }
          };
        
        // choose the element and pass it to html2pdf() function and call the save() on it to save as pdf.
        html2pdf().set(opt).from(element).save();
      }
</script>







<script> 
total = {{data.idk}} +{{data.noo}}+ {{data.yess}}

 yes = {{data.yess}}
 no = {{data.noo}}
 idk = {{data.idk}}
yess = Math.round(yes * 100 / total );
noo =  Math.round(no * 100 / total  );
idkk =  Math.round(idk * 100 / total  );
document.getElementById("demo").innerHTML = yess  + "%";
document.getElementById("demo1").innerHTML = noo + "%";
document.getElementById("demo2").innerHTML =  idkk + "%";


</script>
{{!-- <p id="demo"></p> --}}
<p id="demo1"></p>
<p id="demo2"></p>

{{!-- <p id="yes">here</p>
<p id="no"></p>
<p id="idk"></p> --}}

{{!-- bar chart top 4 --}}

{{!-- 
Top 4 secured categories:

<div class="row">
                    <div class="col-lg-6">
                        <div class="card">
                            <div class="card-header">
                                <h4 class="card-title">Basic Bar Chart</h4>
                            </div><!--end card-header-->
                            <div class="card-body">
                                <div class="chart-demo">
                                    <div id="apex_bar" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->
                     <!-- Javascript  -->
     --}}
    <script>

  
var options = {
  chart: {
      height: 380,
      type: 'bar',
      toolbar: {
          show: false
      },
  },
  plotOptions: {
      bar: {
          horizontal: true,
      }
  },
  dataLabels: {
      enabled: false
  },
  series: [{
      data: [{{#each bar}}
       
        {{this.count}},
          
            
            {{/each}}]
  }],
  colors: ["#2a76f4"],
  yaxis: {
      axisBorder: {
          show: true,
          color: '#bec7e0',
        },  
        axisTicks: {
          show: true,
          color: '#bec7e0',
      }, 
  },
  xaxis: {
      categories: [ {{#each bar}}
       
        '{{this.sub}}',
          
            
            {{/each}}
            ],        
  },
  states: {
      hover: {
          filter: 'none'
      }
  },
  grid: {
      borderColor: '#f1f3fa'
  }
}

var chart = new ApexCharts(
  document.querySelector("#apex_bar"),
  options
);

chart.render();
</script>

            {{!-- {{#each bar}}
       
        '{{this.sub}}',
          
            
            {{/each}} --}}
{{!--             
Top 4 vulnerable categories:

<div class="row">
                    <div class="col-lg-6">
                        <div class="card">
                            <div class="card-header">
                                <h4 class="card-title">Basic Bar Chart</h4>
                            </div><!--end card-header-->
                            <div class="card-body">
                                <div class="chart-demo">
                                    <div id="apex_bar1" class="apex-charts"></div>
                                </div>                                        
                            </div><!--end card-body-->
                        </div><!--end card-->
                    </div><!--end col-->
                     <!-- Javascript  -->
     --}}
    <script>

  
var options = {
  chart: {
      height: 380,
      type: 'bar',
      toolbar: {
          show: false
      },
  },
  plotOptions: {
      bar: {
          horizontal: true,
      }
  },
  dataLabels: {
      enabled: false
  },
  series: [{
      data: [{{#each bar1}}
       
        {{this.count}},
          
            
            {{/each}}]
  }],
  colors: ["#fa0505"],
  yaxis: { 
      axisBorder: {
          show: true,
          color: '#bec7e0',
        },  
        axisTicks: {
          show: true,
          color: '#bec7e0',
      }, 
  },
  xaxis: {
      categories: [ {{#each bar1}}
       
        '{{this.sub}}',
          
            
            {{/each}}
            ],        
  },
  states: {
      hover: {
          filter: 'none'
      }
  },
  grid: {
      borderColor: '#f1f3fa'
  }
}

var chart = new ApexCharts(
  document.querySelector("#apex_bar1"),
  options
);

chart.render();
</script>

            {{!-- {{#each r3}}
       
        '{{this.count}}',
          
            
            {{/each}} --}}


 {{!-- summery script  --}}
 <script>

  
var options = {
  chart: {
      height: 150,
            width: 600,

      type: 'bar',
      toolbar: {
          show: false
      },
  },
  plotOptions: {
      bar: {
          horizontal: true,
      }
  },
  dataLabels: {
      enabled: false
  },
  series: [{
      data: [{{data.yess}} , {{data.noo}} ]
  }],
  colors: ["#2a76f4"],
  yaxis: {
      axisBorder: {
          show: true,
          color: '#bec7e0',
        },  
        axisTicks: {
          show: true,
          color: '#bec7e0',
      }, 
  },
  xaxis: {
      categories: [ 'apporoved' , 'denied'
            ],        
  },
  states: {
      hover: {
          filter: 'none'
      }
  },
  grid: {
      borderColor: '#f1f3fa'
  }
}

var chart = new ApexCharts(
  document.querySelector("#apex_bar2"),
  options
);

chart.render();
</script>

{{!-- category script --}}
<script> 
 var options = {
  chart: {
      height: 396,
      type: 'bar',
      toolbar: {
          show: false
      },
  },
  plotOptions: {
      bar: {
          horizontal: false,
          endingShape: 'rounded',
          columnWidth: '55%',
      },
  },
  dataLabels: {
      enabled: false
  },
  stroke: {
      show: true,
      width: 2,
      colors: ['transparent']
  },
  colors: ["rgba(42, 118, 244, .18)", '#2a76f4', "rgba(251, 182, 36, .6)"],
  series: [{
      name: 'total',
      data: [
                  {{#each r3}}
       
        {{this.count}},
          
            
            {{/each}}
      
      
      ]
  }, {
      name: 'secured ',
      data: [
      
      {{#each r2}}
       
        {{this.count}},
          
            
            {{/each}}
      ]
  }, {
      name: 'not secured',
      data: [
      
       {{#each r1}}
       
        {{this.count}},
          
            
            {{/each}}
      ]
  }],
  xaxis: {
      categories: [
      
        {{#each r3}}
       
        '{{this.sub}}',
          
            
            {{/each}}
      
      ],
      axisBorder: {
          show: true,
          color: '#bec7e0',
        },  
        axisTicks: {
          show: true,
          color: '#bec7e0',
      },    
  },
  legend: {
      offsetY: 6,
  },
  yaxis: {
      title: {
          text: '$ (thousands)'
      }
  },
  fill: {
      opacity: 1

  },
  // legend: {
  //     floating: true
  // },
  grid: {
      row: {
          colors: ['transparent', 'transparent'], // takes an array which will be repeated on columns
          opacity: 0.2
      },
      borderColor: '#f1f3fa'
  },
  tooltip: {
      y: {
          formatter: function (val) {
              return "$ " + val + " thousands"
          }
      }
  }
}

var chart = new ApexCharts(
  document.querySelector("#apex_column1"),
  options   
);

chart.render();
</script>

</body>
</html>